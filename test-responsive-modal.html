<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ClickFeedback Responsive Modal Test</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
            background: #f5f5f5;
        }
        
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .test-button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px;
        }
        
        .test-button:hover {
            filter: brightness(1.05);
        }
        
        .screenshot-placeholder {
            width: 100%;
            height: 600px;
            background: linear-gradient(45deg, #f0f0f0 25%, transparent 25%), 
                        linear-gradient(-45deg, #f0f0f0 25%, transparent 25%), 
                        linear-gradient(45deg, transparent 75%, #f0f0f0 75%), 
                        linear-gradient(-45deg, transparent 75%, #f0f0f0 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .instructions {
            background: #e3f2fd;
            padding: 16px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #2196f3;
        }
        
        .responsive-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin: 20px 0;
        }
        
        .info-card {
            background: #f8f9fa;
            padding: 16px;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ClickFeedback Responsive Modal Test</h1>
        
        <div class="instructions">
            <h3>Test Instructions:</h3>
            <ol>
                <li>Click "Test Short Screenshot" to see the modal with a short image</li>
                <li>Click "Test Long Screenshot" to see the modal with a tall image</li>
                <li>Resize your browser window to test responsive behavior</li>
                <li>Try different screen orientations on mobile devices</li>
                <li>Verify that the submit button is always visible</li>
            </ol>
        </div>
        
        <div class="responsive-info">
            <div class="info-card">
                <h4>Responsive Features</h4>
                <ul>
                    <li>Dynamic height adjustment</li>
                    <li>Sticky footer with submit button</li>
                    <li>Scrollable content area</li>
                    <li>Mobile-optimized layout</li>
                </ul>
            </div>
            
            <div class="info-card">
                <h4>Screen Size Support</h4>
                <ul>
                    <li>Desktop: 768px+</li>
                    <li>Tablet: 640px - 768px</li>
                    <li>Mobile: < 640px</li>
                    <li>Short height: < 600px</li>
                </ul>
            </div>
        </div>
        
        <button class="test-button" onclick="testModal('short')">
            Test Short Screenshot
        </button>
        
        <button class="test-button" onclick="testModal('long')">
            Test Long Screenshot
        </button>
        
        <div class="screenshot-placeholder">
            <div style="text-align: center; padding-top: 250px; color: #666;">
                Screenshot Placeholder<br>
                (This simulates the webpage content)
            </div>
        </div>
    </div>

    <script>
        function testModal(type) {
            // Create a mock screenshot based on type
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            if (type === 'long') {
                canvas.width = 400;
                canvas.height = 800;
                ctx.fillStyle = '#e3f2fd';
                ctx.fillRect(0, 0, 400, 800);
                ctx.fillStyle = '#2196f3';
                ctx.fillRect(50, 100, 300, 600);
                ctx.fillStyle = '#1976d2';
                ctx.font = '24px Arial';
                ctx.fillText('Long Screenshot Test', 100, 150);
                ctx.fillText('This is a tall image', 100, 200);
                ctx.fillText('that tests the modal', 100, 250);
                ctx.fillText('responsive behavior', 100, 300);
            } else {
                canvas.width = 400;
                canvas.height = 300;
                ctx.fillStyle = '#f3e5f5';
                ctx.fillRect(0, 0, 400, 300);
                ctx.fillStyle = '#9c27b0';
                ctx.fillRect(50, 50, 300, 200);
                ctx.fillStyle = '#7b1fa2';
                ctx.font = '24px Arial';
                ctx.fillText('Short Screenshot Test', 100, 150);
            }
            
            const screenshot = canvas.toDataURL();
            
            // Simulate opening the modal
            openModal(screenshot, {
                tagName: 'DIV',
                id: 'test-element',
                selector: '#test-element'
            });
        }
        
        // Mock modal function for testing
        function openModal(screenshot, elementInfo) {
            const overlay = document.createElement('div');
            overlay.className = 'cf-overlay';
            overlay.style.cssText = `
                position: fixed;
                inset: 0;
                z-index: 2147483647;
                display: block;
                overflow-y: auto;
                padding: 20px;
                box-sizing: border-box;
                background: rgba(0,0,0,0.4);
                backdrop-filter: blur(2px);
            `;
            
            const modal = document.createElement('div');
            modal.className = 'cf-modal';
            modal.style.cssText = `
                position: relative;
                margin: 0 auto;
                max-width: 720px;
                min-height: fit-content;
                max-height: calc(100vh - 40px);
                background: white;
                color: #222;
                border: 1px solid #e5e7eb;
                border-radius: 12px;
                box-shadow: 0 20px 60px rgba(0,0,0,0.2);
                overflow: hidden;
                display: flex;
                flex-direction: column;
                box-sizing: border-box;
            `;
            
            const header = document.createElement('div');
            header.style.cssText = `
                padding: 16px 20px;
                border-bottom: 1px solid #e5e7eb;
                display: flex;
                align-items: center;
                justify-content: space-between;
                flex-shrink: 0;
            `;
            header.innerHTML = `
                <div style="font: 600 16px/1.4 system-ui, sans-serif;">Give Feedback</div>
                <button onclick="this.closest('.cf-overlay').remove()" style="
                    appearance: none;
                    background: transparent;
                    border: 0;
                    cursor: pointer;
                    padding: 6px;
                    border-radius: 8px;
                    font-size: 18px;
                ">✕</button>
            `;
            
            const body = document.createElement('div');
            body.style.cssText = `
                display: flex;
                flex-direction: column;
                gap: 16px;
                padding: 16px 20px;
                flex: 1;
                overflow-y: auto;
                min-height: 0;
                max-height: calc(100vh - 200px);
            `;
            
            const preview = document.createElement('div');
            preview.style.cssText = `
                display: flex;
                gap: 12px;
                align-items: flex-start;
                flex-shrink: 0;
            `;
            
            const shot = document.createElement('img');
            shot.src = screenshot;
            shot.style.cssText = `
                width: 100%;
                max-height: min(300px, 40vh);
                object-fit: contain;
                border-radius: 10px;
                border: 1px solid #e5e7eb;
                box-shadow: 0 10px 24px rgba(0,0,0,0.15);
            `;
            preview.appendChild(shot);
            
            const meta = document.createElement('div');
            meta.style.cssText = `
                font-size: 12px;
                color: #6b7280;
                flex-shrink: 0;
            `;
            meta.textContent = `${elementInfo.tagName}#${elementInfo.id} · example.com`;
            
            const fields = document.createElement('div');
            fields.style.cssText = `
                display: grid;
                gap: 12px;
                flex-shrink: 0;
            `;
            
            const commentField = document.createElement('div');
            commentField.innerHTML = `
                <label style="display: block; font: 600 12px/1.2 system-ui, sans-serif; margin-bottom: 6px; color: #222;">What happened?</label>
                <textarea placeholder="Describe the issue or feedback…" style="
                    width: 100%;
                    box-sizing: border-box;
                    border: 1px solid #e5e7eb;
                    border-radius: 10px;
                    padding: 10px 12px;
                    background: white;
                    color: #222;
                    font: 500 13px/1.4 system-ui, sans-serif;
                    outline: none;
                    min-height: 84px;
                    resize: vertical;
                "></textarea>
            `;
            
            const row = document.createElement('div');
            row.style.cssText = `
                display: grid;
                gap: 12px;
                grid-template-columns: 1fr 1fr;
            `;
            
            const categoryField = document.createElement('div');
            categoryField.innerHTML = `
                <label style="display: block; font: 600 12px/1.2 system-ui, sans-serif; margin-bottom: 6px; color: #222;">Category</label>
                <select style="
                    width: 100%;
                    box-sizing: border-box;
                    border: 1px solid #e5e7eb;
                    border-radius: 10px;
                    padding: 10px 12px;
                    background: white;
                    color: #222;
                    font: 500 13px/1.4 system-ui, sans-serif;
                    outline: none;
                ">
                    <option value="bug">Bug</option>
                    <option value="design">Design</option>
                    <option value="usability">Usability</option>
                    <option value="performance">Performance</option>
                    <option value="feature">Feature</option>
                    <option value="other">Other</option>
                </select>
            `;
            
            const priorityField = document.createElement('div');
            priorityField.innerHTML = `
                <label style="display: block; font: 600 12px/1.2 system-ui, sans-serif; margin-bottom: 6px; color: #222;">Priority</label>
                <select style="
                    width: 100%;
                    box-sizing: border-box;
                    border: 1px solid #e5e7eb;
                    border-radius: 10px;
                    padding: 10px 12px;
                    background: white;
                    color: #222;
                    font: 500 13px/1.4 system-ui, sans-serif;
                    outline: none;
                ">
                    <option value="low">Low</option>
                    <option value="medium">Medium</option>
                    <option value="high">High</option>
                    <option value="critical">Critical</option>
                </select>
            `;
            
            row.appendChild(categoryField);
            row.appendChild(priorityField);
            
            const emailField = document.createElement('div');
            emailField.innerHTML = `
                <label style="display: block; font: 600 12px/1.2 system-ui, sans-serif; margin-bottom: 6px; color: #222;">Email (optional)</label>
                <input type="email" placeholder="you@company.com" style="
                    width: 100%;
                    box-sizing: border-box;
                    border: 1px solid #e5e7eb;
                    border-radius: 10px;
                    padding: 10px 12px;
                    background: white;
                    color: #222;
                    font: 500 13px/1.4 system-ui, sans-serif;
                    outline: none;
                ">
            `;
            
            fields.appendChild(commentField);
            fields.appendChild(row);
            fields.appendChild(emailField);
            
            body.appendChild(preview);
            body.appendChild(meta);
            body.appendChild(fields);
            
            const footer = document.createElement('div');
            footer.style.cssText = `
                display: flex;
                align-items: center;
                justify-content: space-between;
                gap: 12px;
                padding: 12px 20px 16px;
                border-top: 1px solid #e5e7eb;
                flex-shrink: 0;
                background: white;
                position: sticky;
                bottom: 0;
                z-index: 1;
            `;
            
            footer.innerHTML = `
                <div style="font-size: 12px; color: #6b7280;">Right‑click powered by ClickFeedback</div>
                <div style="display: flex; gap: 12px;">
                    <button onclick="this.closest('.cf-overlay').remove()" style="
                        appearance: none;
                        border: 0;
                        border-radius: 10px;
                        padding: 10px 14px;
                        font: 600 13px/1.2 system-ui, sans-serif;
                        cursor: pointer;
                        background: transparent;
                        color: #222;
                    ">Cancel</button>
                    <button onclick="alert('Feedback submitted!')" style="
                        appearance: none;
                        border: 0;
                        border-radius: 10px;
                        padding: 10px 14px;
                        font: 600 13px/1.2 system-ui, sans-serif;
                        cursor: pointer;
                        color: white;
                        background: linear-gradient(135deg, #667eea, #764ba2);
                        box-shadow: 0 10px 24px rgba(102, 126, 234, 0.35);
                    ">Submit Feedback</button>
                </div>
            `;
            
            modal.appendChild(header);
            modal.appendChild(body);
            modal.appendChild(footer);
            
            overlay.appendChild(modal);
            document.body.appendChild(overlay);
            
            // Add responsive behavior
            const adjustModalPosition = () => {
                const viewportHeight = window.innerHeight;
                const viewportWidth = window.innerWidth;
                const modalRect = modal.getBoundingClientRect();
                
                if (modalRect.height > viewportHeight - 40) {
                    modal.style.maxHeight = `${viewportHeight - 40}px`;
                }
                
                if (viewportWidth < 768) {
                    overlay.style.padding = '10px';
                } else {
                    overlay.style.padding = '20px';
                }
            };
            
            adjustModalPosition();
            
            const resizeObserver = new ResizeObserver(adjustModalPosition);
            resizeObserver.observe(modal);
            
            window.addEventListener('orientationchange', () => {
                setTimeout(adjustModalPosition, 100);
            });
            
            // Cleanup on close
            const closeButtons = overlay.querySelectorAll('button');
            closeButtons.forEach(btn => {
                if (btn.textContent === '✕' || btn.textContent === 'Cancel') {
                    btn.addEventListener('click', () => {
                        resizeObserver.disconnect();
                    });
                }
            });
        }
    </script>
</body>
</html>
